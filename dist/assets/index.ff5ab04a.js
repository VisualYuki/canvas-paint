var c=Object.defineProperty;var g=(n,t,o)=>t in n?c(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o;var l=(n,t,o)=>(g(n,typeof t!="symbol"?t+"":t,o),o);const b=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const i of e)if(i.type==="childList")for(const m of i.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&r(m)}).observe(document,{childList:!0,subtree:!0});function o(e){const i={};return e.integrity&&(i.integrity=e.integrity),e.referrerpolicy&&(i.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?i.credentials="include":e.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(e){if(e.ep)return;e.ep=!0;const i=o(e);fetch(e.href,i)}};b();class f{constructor(){l(this,"canvasNode",document.getElementById("canvas"));l(this,"ctx");l(this,"canvasSettings",{});l(this,"canvasSettingsValues",["lineWidth","fillStyle","strokeStyle"]);this.ctx=this.canvasNode.getContext("2d")}saveCanvasSettings(){for(let t of a.canvasSettingsValues)a.canvasSettings[t]=a.ctx[t]}restoreCanvasSettings(){for(let t of a.canvasSettingsValues)a.ctx[t]=a.canvasSettings[t]}writeLine(t,o,r){r?this.ctx.moveTo(t,o):(this.ctx.lineTo(t,o),this.ctx.stroke())}getPixelColor(t,o){let r=this.ctx.getImageData(t,o,1,1).data;return`#${r[0].toString(16)}${r[1].toString(16)}${r[2].toString(16)}`}setPencilThickness(t){let o;switch(t){case 1:o=1;break;case 2:o=3;break;case 3:o=5;break;case 4:o=10;break}this.ctx.beginPath(),this.ctx.lineWidth=o}setPencilColor(t){this.ctx.beginPath(),this.ctx.strokeStyle=t}clearCanvas(t,o){this.saveCanvasSettings(),this.ctx.fillStyle="#ffffff",this.ctx.fillRect(0,0,t,o),this.ctx.beginPath(),this.restoreCanvasSettings()}}let a=new f;class u{constructor(t){l(this,"view");l(this,"canvasWidth");l(this,"canvasHeight");this.view=t}clearCanvas(){a.clearCanvas(this.canvasWidth,this.canvasHeight)}getPixelColor(t,o){let r=a.getPixelColor(t,o);this.setColor(r)}downloadImage(){this.view.downloadImage()}uploadImage(t){this.view.uploadImage(t)}writeLine(t,o,r){a.writeLine(t,o,r)}setColor(t){a.setPencilColor(t),this.view.updateCurrentColor(t),this.view.setInputColor(t)}setThickness(t){a.setPencilThickness(+t)}setCanvasWidth(t){this.canvasWidth=t,this.view.setCanvasWidth(this.canvasWidth),this.view.setCanvasWidthText(this.canvasWidth)}setCanvasHeight(t){this.canvasHeight=t,this.view.setCanvasHeight(this.canvasHeight),this.view.setCanvasHeightText(this.canvasHeight)}setMouseCoordinatesText(t,o){this.view.setMouseCoordinatesText(t,o)}}var p=(n=>(n.pencil="pencil",n.colorPicker="colorPicker",n.eraser="eraser",n.text="text",n.fillColor="fillColor",n))(p||{});class x{constructor(t,o){l(this,"model");l(this,"view");l(this,"lastToolType");l(this,"canvas",document.getElementById("canvas"));l(this,"mainContent",document.querySelector(".main-content"));l(this,"canvasWrap",document.querySelector(".canvas-wrap"));this.model=t,this.view=o,this.initCanvasResizeEvents(),this.initBottomPanelEvents(),this.initTopPanelEvents()}initTopPanelEvents(){this.setToolType("pencil"),document.querySelectorAll(".top-panel .tools img[data-tool-name]").forEach(t=>{t.addEventListener("click",()=>{let o=p[t.getAttribute("data-tool-name")];this.setToolType(o)})}),document.querySelector(".top-panel .thickness__range").addEventListener("change",t=>{const o=t.target;this.model.setThickness(o.value)}),document.querySelector(".top-panel .tools .clear").addEventListener("click",()=>{this.model.clearCanvas()}),document.querySelector(".top-panel .palette__color-input").addEventListener("change",t=>{const o=t.target;this.model.setColor(o.value)}),document.querySelector(".top-panel .file .download").addEventListener("click",()=>{this.model.downloadImage()}),document.querySelector(".top-panel .file .upload input").addEventListener("change",t=>{this.model.uploadImage(t.target.files[0])}),this.model.setColor("#000000")}setToolType(t){this.removeLastToolType(),this.lastToolType=t,t==="pencil"?(document.documentElement.classList.add("pencil-cursor"),document.querySelector(".top-panel img[data-tool-name='pencil']").classList.add("active"),this.canvas.onmousedown=o=>{this.model.writeLine(o.offsetX,o.offsetY,!0),this.canvas.onmousemove=r=>{this.model.writeLine(r.offsetX,r.offsetY,!1)},this.canvas.onmouseup=()=>{this.canvas.onmousemove=null}}):t==="colorPicker"&&(document.querySelector(".top-panel img[data-tool-name='colorPicker']").classList.add("active"),this.canvas.onmousedown=o=>{this.model.getPixelColor(o.offsetX,o.offsetY)})}removeLastToolType(){document.querySelectorAll(".top-panel img").forEach(t=>{t.classList.remove("active")}),this.canvas.onmousedown=null,this.lastToolType==="pencil"?document.documentElement.classList.remove("pencil-cursor"):this.lastToolType}initBottomPanelEvents(){this.canvas.addEventListener("mousemove",o=>{this.model.setMouseCoordinatesText(o.offsetX,o.offsetY)}),this.canvas.addEventListener("mouseleave",()=>{this.model.setMouseCoordinatesText(-1,-1)});const t=100;this.model.setCanvasWidth(document.documentElement.clientWidth-t),this.model.setCanvasHeight(600)}initCanvasResizeEvents(){let t=document.querySelector(".canvas-wrap .right-resize-btn"),o=document.querySelector(".canvas-wrap .bottom-resize-btn"),r=document.querySelector(".canvas-wrap .bottom-right-resize-btn");o.addEventListener("mousedown",()=>{e("bottom")}),t.addEventListener("mousedown",()=>{e("right")}),r.addEventListener("mousedown",()=>{e("bottom-right")});let e=i=>{this.view.setResizeCursor(i);let m=d=>{(i==="right"||i==="bottom-right")&&this.model.setCanvasWidth(d.pageX-this.canvasWrap.getBoundingClientRect().x),(i==="bottom"||i==="bottom-right")&&this.model.setCanvasHeight(d.pageY-this.canvasWrap.getBoundingClientRect().y)};this.mainContent.onmousemove=d=>{m(d)},this.mainContent.onmouseup=d=>{m(d),this.view.removeResizeCursor(i),this.mainContent.onmouseup=null,this.mainContent.onmousemove=null}}}}class h{constructor(){}downloadImage(){let t=document.createElement("a");document.body.appendChild(t),t.href=a.canvasNode.toDataURL(),t.download="canvs image.png",t.click(),document.body.removeChild(t)}uploadImage(t){let o=URL.createObjectURL(t),r=new Image;r.src=o,r.onload=()=>{a.ctx.drawImage(r,0,0)}}drawStartFakeCanvas(){return a.saveCanvasSettings(),a.canvasNode.toDataURL("image/png")}drawEndFakeCanvas(t){var o=document.createElement("img");o.src=t,o.onload=()=>{a.ctx.drawImage(o,0,0)},a.restoreCanvasSettings()}setInputColor(t){document.querySelector(".top-panel .palette__color-input").value=t}updateCurrentColor(t){document.querySelector(".current-color__color").setAttribute("style",`background: ${t}`)}setCanvasWidth(t){let o=this.drawStartFakeCanvas();a.canvasNode.setAttribute("width",t.toString()),this.drawEndFakeCanvas(o)}setCanvasHeight(t){let o=this.drawStartFakeCanvas();a.canvasNode.setAttribute("height",t.toString()),this.drawEndFakeCanvas(o)}setCanvasWidthText(t){document.querySelector(".bottom-panel .canvas-size .width").textContent=t.toString()}setCanvasHeightText(t){document.querySelector(".bottom-panel .canvas-size .height").textContent=t.toString()}setMouseCoordinatesText(t,o){let r=document.querySelector(".mouse-coordinates");t===-1&&o===-1?r.innerHTML="":r.innerHTML=`${t}, ${o}`}setResizeCursor(t){t==="right"?document.body.classList.add("ew-resize"):t==="bottom"?document.body.classList.add("ns-resize"):t==="bottom-right"&&document.body.classList.add("nwse-resize")}removeResizeCursor(t){t==="right"?document.body.classList.remove("ew-resize"):t==="bottom"?document.body.classList.remove("ns-resize"):t==="bottom-right"&&document.body.classList.remove("nwse-resize")}}let s=new h,w=new u(s);new x(w,s);
