var s=Object.defineProperty;var c=(a,t,o)=>t in a?s(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o;var n=(a,t,o)=>(c(a,typeof t!="symbol"?t+"":t,o),o);const g=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const e of r)if(e.type==="childList")for(const l of e.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function o(r){const e={};return r.integrity&&(e.integrity=r.integrity),r.referrerpolicy&&(e.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?e.credentials="include":r.crossorigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function i(r){if(r.ep)return;r.ep=!0;const e=o(r);fetch(r.href,e)}};g();class b{constructor(t){n(this,"view");n(this,"canvasWidth");n(this,"canvasHeight");this.view=t}writeLine(t,o,i){this.view.writeLine(t,o,i)}setColor(t){this.view.setPencilColor(t),this.view.updateCurrentColor(t),this.view.setInputColor(t)}setThickness(t){this.view.setPencilThickness(+t)}setCanvasWidth(t){this.canvasWidth=t,this.view.setCanvasWidth(this.canvasWidth),this.view.setCanvasWidthText(this.canvasWidth)}setCanvasHeight(t){this.canvasHeight=t,this.view.setCanvasHeight(this.canvasHeight),this.view.setCanvasHeightText(this.canvasHeight)}setMouseCoordinatesText(t,o){this.view.setMouseCoordinatesText(t,o)}}var d=(a=>(a.pencil="pencil",a.colorPicker="colorPicker",a.eraser="eraser",a.text="text",a.fillColor="fillColor",a))(d||{});class f{constructor(t,o){n(this,"model");n(this,"view");n(this,"lastEvent");n(this,"canvas",document.getElementById("canvas"));n(this,"mainContent",document.querySelector(".main-content"));n(this,"canvasWrap",document.querySelector(".canvas-wrap"));this.model=t,this.view=o,this.initCanvasResizeEvents(),this.initBottomPanelEvents(),this.initTopPanelEvents()}initTopPanelEvents(){this.setToolEvent("pencil"),document.querySelectorAll(".top-panel  .tools img").forEach(t=>{t.addEventListener("click",()=>{let o=d[t.getAttribute("data-tool-name")];this.setToolEvent(o)})}),document.querySelector(".top-panel .thickness__range").addEventListener("change",t=>{const o=t.target;this.model.setThickness(o.value)}),document.querySelector(".top-panel .palette__color-input").addEventListener("change",t=>{const o=t.target;this.model.setColor(o.value)}),this.model.setColor("#000000")}setToolEvent(t){t==="pencil"&&(document.documentElement.classList.add("pencil-cursor"),document.querySelector(".top-panel img[data-tool-name='pencil']").classList.add("active"),this.canvas.onmousedown=o=>{this.model.writeLine(o.offsetX,o.offsetY,!0),this.canvas.onmousemove=i=>{this.model.writeLine(i.offsetX,i.offsetY,!1)},this.canvas.onmouseup=()=>{this.canvas.onmousemove=null}})}initBottomPanelEvents(){this.canvas.addEventListener("mousemove",o=>{this.model.setMouseCoordinatesText(o.offsetX,o.offsetY)}),this.canvas.addEventListener("mouseleave",()=>{this.model.setMouseCoordinatesText(-1,-1)});const t=100;this.model.setCanvasWidth(document.documentElement.clientWidth-t),this.model.setCanvasHeight(600)}initCanvasResizeEvents(){let t=document.querySelector(".canvas-wrap .right-resize-btn"),o=document.querySelector(".canvas-wrap .bottom-resize-btn"),i=document.querySelector(".canvas-wrap .bottom-right-resize-btn");o.addEventListener("mousedown",()=>{r("bottom")}),t.addEventListener("mousedown",()=>{r("right")}),i.addEventListener("mousedown",()=>{r("bottom-right")});let r=e=>{this.view.setResizeCursor(e);let l=m=>{(e==="right"||e==="bottom-right")&&this.model.setCanvasWidth(m.pageX-this.canvasWrap.getBoundingClientRect().x),(e==="bottom"||e==="bottom-right")&&this.model.setCanvasHeight(m.pageY-this.canvasWrap.getBoundingClientRect().y)};this.mainContent.onmousemove=m=>{l(m)},this.mainContent.onmouseup=m=>{l(m),this.view.removeResizeCursor(e),this.mainContent.onmouseup=null,this.mainContent.onmousemove=null}}}}class u{constructor(){n(this,"canvasNode",document.getElementById("canvas"));n(this,"ctx");let t=document.getElementById("canvas");this.ctx=t.getContext("2d"),this.ctx.strokeStyle="red"}writeLine(t,o,i){i?this.ctx.moveTo(t,o):(this.ctx.lineTo(t,o),this.ctx.stroke())}drawStartFakeCanvas(){return console.log(this.ctx.strokeStyle),this.ctx.save(),this.canvasNode.toDataURL("image/png")}setPencilColor(t){this.ctx.beginPath(),this.ctx.strokeStyle=t}setInputColor(t){document.querySelector(".top-panel .palette__color-input").value=t}updateCurrentColor(t){document.querySelector(".current-color__color").setAttribute("style",`background: ${t}`)}setPencilThickness(t){let o;switch(t){case 1:o=1;break;case 2:o=3;break;case 3:o=5;break;case 4:o=10;break}this.ctx.beginPath(),this.ctx.lineWidth=o}drawEndFakeCanvas(t){var o=document.createElement("img");o.src=t,o.onload=()=>{this.ctx.drawImage(o,0,0)},this.ctx.restore(),console.log(this.ctx.strokeStyle)}setCanvasWidth(t){let o=this.drawStartFakeCanvas();this.canvasNode.setAttribute("width",t.toString()),this.drawEndFakeCanvas(o)}setCanvasHeight(t){let o=this.drawStartFakeCanvas();this.canvasNode.setAttribute("height",t.toString()),this.drawEndFakeCanvas(o)}setCanvasWidthText(t){document.querySelector(".bottom-panel .canvas-size .width").textContent=t.toString()}setCanvasHeightText(t){document.querySelector(".bottom-panel .canvas-size .height").textContent=t.toString()}setMouseCoordinatesText(t,o){let i=document.querySelector(".mouse-coordinates");t===-1&&o===-1?i.innerHTML="":i.innerHTML=`${t}, ${o}`}setResizeCursor(t){t==="right"?document.body.classList.add("ew-resize"):t==="bottom"?document.body.classList.add("ns-resize"):t==="bottom-right"&&document.body.classList.add("nwse-resize")}removeResizeCursor(t){t==="right"?document.body.classList.remove("ew-resize"):t==="bottom"?document.body.classList.remove("ns-resize"):t==="bottom-right"&&document.body.classList.remove("nwse-resize")}}let p=new u,x=new b(p);new f(x,p);
